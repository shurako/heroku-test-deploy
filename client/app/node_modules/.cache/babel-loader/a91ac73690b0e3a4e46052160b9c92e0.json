{"ast":null,"code":"import _objectSpread from\"C:/Users/patry/OneDrive/Pulpit/DB learn/client/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"C:/Users/patry/OneDrive/Pulpit/DB learn/client/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Users/patry/OneDrive/Pulpit/DB learn/client/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/patry/OneDrive/Pulpit/DB learn/client/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/patry/OneDrive/Pulpit/DB learn/client/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import'./Home.css';import Board from'../components/board/Board';import axios from'axios';import BottomBar from'../components/BottomBar/BottomBar';import{DragDropContext}from'react-beautiful-dnd';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Home(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),boards=_useState2[0],setBoards=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),operation=_useState4[0],setOperation=_useState4[1];var boardsRef=useRef();var fetchBoards=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var boards;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/boards');case 2:boards=_context.sent;setBoards(boards.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function fetchBoards(){return _ref.apply(this,arguments);};}();useEffect(function(){fetchBoards();},[]);var handleOnDragEnd=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(result){var sourceBoard,destBoard,_sourceBoard$content$,_sourceBoard$content$2,removed,board,source,_source$splice,_source$splice2,reorderedItem,newArray;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(result);if(result.destination){_context2.next=3;break;}return _context2.abrupt(\"return\");case 3:if(result.source.droppableId!==result.destination.droppableId){sourceBoard=boards.find(function(board){return board._id==result.source.droppableId;});destBoard=boards.find(function(board){return board._id==result.destination.droppableId;});_sourceBoard$content$=sourceBoard.content.splice(result.source.index,1),_sourceBoard$content$2=_slicedToArray(_sourceBoard$content$,1),removed=_sourceBoard$content$2[0];destBoard.content.splice(result.destination.index,0,removed);setBoards(_toConsumableArray(boards));}else{board=boards.find(function(board){return board._id==result.source.droppableId;});source=board.content;_source$splice=source.splice(result.source.index,1),_source$splice2=_slicedToArray(_source$splice,1),reorderedItem=_source$splice2[0];source.splice(result.destination.index,0,reorderedItem);newArray=boards.map(function(item){if(board._id!==item._id){return item;}else{return _objectSpread(_objectSpread({},item),{},{content:source});}});setBoards(_toConsumableArray(newArray));}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function handleOnDragEnd(_x){return _ref2.apply(this,arguments);};}();var renderBoards=function renderBoards(){return/*#__PURE__*/_jsx(\"div\",{ref:boardsRef,className:\"boards__wrapper\",children:/*#__PURE__*/_jsx(DragDropContext,{onDragEnd:function onDragEnd(result){handleOnDragEnd(result);},children:boards.map(function(board){return/*#__PURE__*/_jsx(Board,{boards:boards,setBoards:setBoards,board:board});})})});};return/*#__PURE__*/_jsxs(\"div\",{className:\"home\",children:[renderBoards(),/*#__PURE__*/_jsx(BottomBar,{boards:boards,setBoards:setBoards})]});}export default Home;","map":{"version":3,"sources":["C:/Users/patry/OneDrive/Pulpit/DB learn/client/app/src/pages/Home.js"],"names":["React","useState","useEffect","useRef","Board","axios","BottomBar","DragDropContext","Home","boards","setBoards","operation","setOperation","boardsRef","fetchBoards","get","data","handleOnDragEnd","result","console","log","destination","source","droppableId","sourceBoard","find","board","_id","destBoard","content","splice","index","removed","reorderedItem","newArray","map","item","renderBoards"],"mappings":"i1BAAA,MAAOA,CAAAA,KAAP,EAAeC,QAAf,CAAyBC,SAAzB,CAAoCC,MAApC,KAAiD,OAAjD,CACA,MAAO,YAAP,CACA,MAAOC,CAAAA,KAAP,KAAkB,2BAAlB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,SAAP,KAAsB,mCAAtB,CACA,OAASC,eAAT,KAAgC,qBAAhC,C,wFAKA,QAASC,CAAAA,IAAT,EAAgB,CACZ,cAA4BP,QAAQ,CAAC,EAAD,CAApC,wCAAOQ,MAAP,eAAeC,SAAf,eACA,eAAkCT,QAAQ,CAAC,IAAD,CAA1C,yCAAOU,SAAP,eAAkBC,YAAlB,eACA,GAAMC,CAAAA,SAAS,CAAGV,MAAM,EAAxB,CACA,GAAMW,CAAAA,WAAW,0FAAG,oKACKT,CAAAA,KAAK,CAACU,GAAN,CAAU,SAAV,CADL,QACVN,MADU,eAEhBC,SAAS,CAACD,MAAM,CAACO,IAAR,CAAT,CAFgB,sDAAH,kBAAXF,CAAAA,WAAW,0CAAjB,CAOAZ,SAAS,CAAC,UAAM,CACZY,WAAW,GACd,CAFQ,CAEN,EAFM,CAAT,CAOA,GAAMG,CAAAA,eAAe,2FAAI,kBAAOC,MAAP,wQACrBC,OAAO,CAACC,GAAR,CAAYF,MAAZ,EADqB,GAGhBA,MAAM,CAACG,WAHS,mEAKrB,GAAIH,MAAM,CAACI,MAAP,CAAcC,WAAd,GAA8BL,MAAM,CAACG,WAAP,CAAmBE,WAArD,CAAkE,CAExDC,WAFwD,CAE1Cf,MAAM,CAACgB,IAAP,CAAY,SAAAC,KAAK,QAAIA,CAAAA,KAAK,CAACC,GAAN,EAAaT,MAAM,CAACI,MAAP,CAAcC,WAA/B,EAAjB,CAF0C,CAGxDK,SAHwD,CAG5CnB,MAAM,CAACgB,IAAP,CAAY,SAAAC,KAAK,QAAIA,CAAAA,KAAK,CAACC,GAAN,EAAaT,MAAM,CAACG,WAAP,CAAmBE,WAApC,EAAjB,CAH4C,uBAK5CC,WAAW,CAACK,OAAZ,CAAoBC,MAApB,CAA2BZ,MAAM,CAACI,MAAP,CAAcS,KAAzC,CAAgD,CAAhD,CAL4C,gEAKvDC,OALuD,2BAM9DJ,SAAS,CAACC,OAAV,CAAkBC,MAAlB,CAAyBZ,MAAM,CAACG,WAAP,CAAmBU,KAA5C,CAAmD,CAAnD,CAAsDC,OAAtD,EAEAtB,SAAS,oBAAKD,MAAL,EAAT,CACH,CATD,IAWK,CACKiB,KADL,CACajB,MAAM,CAACgB,IAAP,CAAY,SAAAC,KAAK,QAAIA,CAAAA,KAAK,CAACC,GAAN,EAAaT,MAAM,CAACI,MAAP,CAAcC,WAA/B,EAAjB,CADb,CAEKD,MAFL,CAEcI,KAAK,CAACG,OAFpB,gBAGuBP,MAAM,CAACQ,MAAP,CAAcZ,MAAM,CAACI,MAAP,CAAcS,KAA5B,CAAmC,CAAnC,CAHvB,kDAGME,aAHN,oBAIDX,MAAM,CAACQ,MAAP,CAAcZ,MAAM,CAACG,WAAP,CAAmBU,KAAjC,CAAwC,CAAxC,CAA2CE,aAA3C,EACMC,QALL,CAKgBzB,MAAM,CAAC0B,GAAP,CAAY,SAAAC,IAAI,CAAI,CACjC,GAAGV,KAAK,CAACC,GAAN,GAAcS,IAAI,CAACT,GAAtB,CAA2B,CAAC,MAAOS,CAAAA,IAAP,CAAY,CAAxC,IACI,CAAE,sCAAWA,IAAX,MAAiBP,OAAO,CAAGP,MAA3B,GAAoC,CAC7C,CAHgB,CALhB,CASDZ,SAAS,oBAAKwB,QAAL,EAAT,CACH,CA1BoB,wDAAJ,kBAAfjB,CAAAA,eAAe,6CAArB,CA8BA,GAAMoB,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACvB,mBAAO,YAAM,GAAG,CAAIxB,SAAb,CAAwB,SAAS,CAAG,iBAApC,uBACH,KAAC,eAAD,EAAiB,SAAS,CAAI,mBAACK,MAAD,CAAY,CAACD,eAAe,CAACC,MAAD,CAAf,CAAwB,CAAnE,UACKT,MAAM,CAAC0B,GAAP,CAAW,SAAAT,KAAK,qBAAI,KAAC,KAAD,EAAO,MAAM,CAAIjB,MAAjB,CAAyB,SAAS,CAAIC,SAAtC,CAAiD,KAAK,CAAIgB,KAA1D,EAAJ,EAAhB,CADL,EADG,EAAP,CAOH,CARD,CAUA,mBACI,aAAK,SAAS,CAAG,MAAjB,WACKW,YAAY,EADjB,cAEI,KAAC,SAAD,EAAW,MAAM,CAAI5B,MAArB,CAA6B,SAAS,CAAIC,SAA1C,EAFJ,GADJ,CAOH,CAED,cAAeF,CAAAA,IAAf","sourcesContent":["import React, {useState, useEffect, useRef} from 'react'\r\nimport './Home.css'\r\nimport Board from '../components/board/Board'\r\nimport axios from 'axios'\r\nimport BottomBar from '../components/BottomBar/BottomBar'\r\nimport { DragDropContext } from 'react-beautiful-dnd'\r\n\r\n\r\n\r\n\r\nfunction Home() {\r\n    const [boards, setBoards] = useState([])\r\n    const [operation, setOperation] = useState(true)\r\n    const boardsRef = useRef()\r\n    const fetchBoards = async () => {\r\n        const boards = await axios.get('/boards')\r\n        setBoards(boards.data)\r\n    }\r\n    \r\n    \r\n\r\n    useEffect(() => { \r\n        fetchBoards()\r\n    }, [])\r\n\r\n\r\n\r\n\r\n    const handleOnDragEnd =  async (result) => {\r\n        console.log(result)\r\n\r\n        if (!result.destination) return;\r\n        \r\n        if (result.source.droppableId !== result.destination.droppableId) {\r\n            \r\n            const sourceBoard = boards.find(board => board._id == result.source.droppableId)\r\n            const destBoard = boards.find(board => board._id == result.destination.droppableId)\r\n\r\n            const [removed] = sourceBoard.content.splice(result.source.index, 1);\r\n            destBoard.content.splice(result.destination.index, 0, removed)\r\n\r\n            setBoards([...boards])\r\n        }\r\n\r\n        else {\r\n            const board = boards.find(board => board._id == result.source.droppableId)\r\n            const source = board.content\r\n            const [reorderedItem] = source.splice(result.source.index, 1)\r\n            source.splice(result.destination.index, 0, reorderedItem)\r\n            const newArray = boards.map( item => {\r\n                if(board._id !== item._id) {return item}\r\n                else{ return {...item, content : source} }\r\n            }  )\r\n            setBoards([...newArray])\r\n        }\r\n    }\r\n\r\n\r\n    const renderBoards = () => {\r\n        return <div  ref = {boardsRef} className = 'boards__wrapper'>\r\n            <DragDropContext onDragEnd = {(result) => {handleOnDragEnd(result)}}>\r\n                {boards.map(board => <Board boards = {boards} setBoards = {setBoards} board = {board}/>)}\r\n            </DragDropContext>\r\n        </div>\r\n            \r\n        \r\n    }\r\n\r\n    return (\r\n        <div className = 'home'>\r\n            {renderBoards()}\r\n            <BottomBar boards = {boards} setBoards = {setBoards} />\r\n        </div>\r\n        \r\n    )\r\n}\r\n\r\nexport default Home\r\n"]},"metadata":{},"sourceType":"module"}